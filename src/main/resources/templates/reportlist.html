<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <th:block th:insert="~{common/header}"/>
</head>

<body>
  <div class="relative overflow-x-auto shadow-md sm:rounded-lg">
    <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
      <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
      <tr>
        <th scope="col" class="px-6 py-3">review No</th>
        <th scope="col" class="px-6 py-3">report Member No</th>
        <th scope="col" class="px-6 py-3">reported Member No</th>
        <th scope="col" class="px-6 py-3">report Type</th>
        <th scope="col" class="px-6 py-3">report</th>
      </tr>
      </thead>
      <tbody id="reportTableBody"></tbody>
    </table>
  </div>

  <script>
    function getReportList(page) {
      axios.get(`/admin-page/report-list?page=${page}`)
              .then(function (response) {
                let reportData = response.data;
                let reportTableBody = document.getElementById('reportTableBody');

                for (let i = 0; i < reportData.content.length; i++) {
                  let report = reportData.content.at(i);
                  let row = document.createElement('tr');

                  let reviewNo = document.createElement('td');
                  reviewNo.textContent = report.reviewNo;
                  reviewNo.classList.add('px-6', 'py-4');
                  row.appendChild(reviewNo);

                  let reportMemberNo = document.createElement('td');
                  reportMemberNo.textContent = report.reportMemberNo;
                  reportMemberNo.classList.add('px-6', 'py-4');
                  row.appendChild(reportMemberNo);

                  let reportedMemberNo = document.createElement('td');
                  reportedMemberNo.textContent = report.reportedMemberNo;
                  reportedMemberNo.classList.add('px-6', 'py-4');
                  row.appendChild(reportedMemberNo);

                  let reportType = document.createElement('td');
                  reportType.textContent = report.reportType;
                  reportType.classList.add('px-6', 'py-4');
                  row.appendChild(reportType);

                  let action = document.createElement('td');
                  let editLink = document.createElement('a');
                  editLink.href = '#';
                  editLink.textContent = 'Edit';
                  editLink.classList.add('text-center');
                  editLink.classList.add('px-6', 'py-4');
                  action.appendChild(editLink);
                  row.appendChild(action);

                  reportTableBody.appendChild(row);
                }

                let paginationButtons = document.getElementById('paginationButtons');
                let pageable = reportData.pageable;
                let currentPage = pageable.pageNumber;
                let totalPages = pageable.totalPages;

                let previousButton = createPaginationButton('Previous', currentPage - 1);
                paginationButtons.appendChild(previousButton);

                for (let pageNumber = 0; pageNumber < totalPages; pageNumber++) {
                  let button = createPaginationButton(pageNumber + 1, pageNumber);
                  paginationButtons.appendChild(button);
                }

                let nextButton = createPaginationButton('Next', currentPage + 1);
                paginationButtons.appendChild(nextButton);

                let showingInfo = document.getElementById('showingInfo');
                let offset = pageable.offset;
                let pageSize = pageable.pageSize;
                let totalElements = pageable.totalElements;
                let startRange = offset + 1;
                let endRange = offset + pageSize;
                if (endRange > totalElements) {
                  endRange = totalElements;
                }
                showingInfo.textContent = `Showing ${startRange}-${endRange} of ${totalElements}`;
              })
              .catch(function (error) {
                console.log(error);
              });
    }

    function createPaginationButton(label, pageNumber) {
      let button = document.createElement('li');
      let link = document.createElement('a');
      link.href = '#';
      link.textContent = label;
      button.appendChild(link);
      button.addEventListener('click', function(event) {
        event.preventDefault();
        console.log(`Clicked page: ${pageNumber}`);
      });
      return button;
    }
  </script>


  <nav class="flex items-center justify-between pt-4" aria-label="Table navigation">
    <span class="text-sm font-normal text-gray-500 dark:text-gray-400">Showing <span class="font-semibold text-gray-900 dark:text-white">1-10</span> of <span class="font-semibold text-gray-900 dark:text-white">1000</span></span>
    <ul class="inline-flex -space-x-px text-sm h-8">
      <li>
        <a href="#" class="flex items-center justify-center px-3 h-8 ml-0 leading-tight text-gray-500 bg-white border border-gray-300 rounded-l-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">Previous</a>
      </li>
      <li>
        <a id="page1Button" href="#" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</a>
      </li>
      <li>
        <a id="page2Button" href="#" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</a>
      </li>
      <li>
        <a id="page3Button" href="#" aria-current="page" class="flex items-center justify-center px-3 h-8 text-blue-600 border border-gray-300 bg-blue-50 hover:bg-blue-100 hover:text-blue-700 dark:border-gray-700 dark:bg-gray-700 dark:text-white">3</a>
      </li>
      <li>
        <a id="page4Button" href="#" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</a>
      </li>
      <li>
        <a id="page5Button" href="#" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</a>
      </li>
      <li>
        <a href="#" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-r-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">Next</a>
      </li>
    </ul>
  </nav>
  <script>
    // Retrieve the current page number from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const currentPage = urlParams.get('page') || 1; // Default to page 1 if not specified

    // Update the button numbers and href attributes
    const page1Button = document.getElementById('page1Button');
    page1Button.textContent = parseInt(currentPage) + 1 ;
    page1Button.addEventListener('click', () => getReportList(parseInt(currentPage)))

    const page2Button = document.getElementById('page2Button');
    page2Button.textContent = parseInt(currentPage) + 2;
    page2Button.addEventListener('click', () => getReportList(parseInt(currentPage) + 1))

    const page3Button = document.getElementById('page3Button');
    page3Button.textContent = parseInt(currentPage) + 3;
    page3Button.addEventListener('click', () => getReportList(parseInt(currentPage) + 2))

    const page4Button = document.getElementById('page4Button');
    page4Button.textContent = parseInt(currentPage) + 4;
    page4Button.addEventListener('click', () => getReportList(parseInt(currentPage) + 3))

    const page5Button = document.getElementById('page5Button');
    page5Button.textContent = parseInt(currentPage) + 5;
    page5Button.addEventListener('click', () => getReportList(parseInt(currentPage) + 4))  </script>

</body>
</html>